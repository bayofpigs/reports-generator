define(["xlwrapper","table","lodash"],function(e,t,n){var r=function(r,i){var s={},o=e.createWorkbook();n(r).forEach(function(e,r){var s=2;(!e||!r)&&i(new Error("Excel Write: Malformed excel object"));var u=t.getSheetWidth(e.data),a=t.getSheetHeight(e.data,e.information);console.log("Width: "+u),console.log("Height: "+a);var f=o.createSheet(r,u,a),l=Math.floor(u/2),c=1,h=t.getLongestWidth(e.data),p=Math.floor((u-2*s)/2-h/2);for(var d=1;d<=h;d++)f.width(d+s+p,20);console.log("center: "+l),console.log("y: "+c),f.set(l,c,e.name),f.border(l,c,{bottom:"thick"}),f.font(l,c,{bold:"true"}),c+=2;var v=e.information;v&&n(v).forEach(function(e,t){f.set(l-1,c,t),f.border(l-1,c,{bottom:"thin",left:"thin",top:"thin",right:"thin"}),f.set(l,c,e),f.border(l,c,{bottom:"thin",right:"thin",top:"thin"}),c++}),c+=3;var m=e.data,g=m.length;for(var y=0;y<g;y++){var b=m[y],p=Math.floor((u-2*s)/2-b.length/2);f.set(p+s,c,b.title),f.border(p+s,c,{bottom:"medium"}),c++;for(var d=1;d<=b.length;d++)f.set(d+s+p,c,b.labels[d-1]),d===1?f.border(d+s+p,c,{left:"thin",top:"thin",bottom:"thin"}):d===b.length?f.border(d+s+p,c,{right:"thin",top:"thin",bottom:"thin"}):f.border(d+s+p,c,{top:"thin",bottom:"thin"});c++;for(var d=0;d<b.entries;d++){var w=b.rows[d];for(var E=1;E<=w.length;E++){f.set(E+s+p,c,w[E-1]);var S={};E===1?S.left="thin":E===w.length&&(S.right="thin"),d===b.entries-1&&(S.bottom="thin"),f.border(E+s+p,c,S)}c++}c+=3}}),s.save=o.save.bind(o),i(null,s)};return r});