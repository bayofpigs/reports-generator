define(["lodash"],function(e){var t=function(e){var t=0;for(var n=0;n<e.length;n++){var r=e[n].getNumColumns();r>t&&(t=r)}return t},n=function(e){var n=10,r=t(e);return r+n},r=function(e,t){var n=5,r=5,i=0,s=t?Object.keys(t).length*3+5:0;for(var o=0;o<e.length;o++){var u=e[o].getNumEntries()+1;i+=u,i+=n}return i+r+s},i=function(t,n,r){if(n.length!=r.length)throw new Error("Table: schema and label array must be the same length");var i=[Number,String,Date,Boolean];e.forEach(n,function(t){var n=e.indexOf(i,t);if(n>-1)return!0;throw new Error("Table: unrecognized schema type "+t+" in schema declaration")}),this.title=t,this.schema=n,this.labels=r,this.length=n.length,this.entries=0,this.rows=[]};return i.prototype.pushRow=function(t){if(t.length!=this.length)throw new Error("Table: Length mismatch");for(var n=0;n<t.length;n++){var r=this.schema[n];if(r===Number){if(!e.isNumber(t[n]))throw new Error("Table: incorrect entry type at index "+n)}else if(r===String){if(!e.isString(t[n]))throw new Error("Table: incorrect entry type at index "+n)}else if(r===Date){if(!e.isDate(t[n]))throw new Error("Table: incorrect entry type at index "+n)}else if(r===Boolean&&!e.isBoolean(t[n]))throw new Error("Table: incorrect entry type at index "+n)}this.rows.push(t),this.entries++},i.prototype.pushObjectRow=function(e){var t=Object.keys(e),n=[];for(var r=0;r<t.length;r++)n[r]=e[t[r]];this.pushRow(n)},i.prototype.getNumEntries=function(){return this.entries},i.prototype.getNumColumns=function(){return this.length},i.getLongestWidth=t,i.getSheetWidth=n,i.getSheetHeight=r,i});