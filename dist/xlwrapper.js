define(["xlsx","filesaver"],function(e,t){function r(e,t){t&&(e+=1462);var n=Date.parse(e);return(n-new Date(Date.UTC(1899,11,30)))/864e5}var n={},i=function(){this.SheetNames=[],this.Sheets={}},s=function(t,n,r){var i={s:{c:0,r:0},e:{c:n,r:r}};console.log(i),console.log(e.utils.encode_range(i)),this.sheet_name=t,this["!ref"]=e.utils.encode_range(i),this.column_count=n,this.row_count=r,this["!cols"]=[];for(var s=0;s<n;s++)this["!cols"][s]={wch:8.48}};return n.createWorkbook=function(){return new i},i.prototype.createSheet=function(e,t,n){var r=new s(e,t,n);return this.Sheets[e]=r,this.SheetNames[this.SheetNames.length]=e,r},i.prototype.cancel=function(){this.SheetNames=[],this.Sheets={}},i.prototype.save=function(n){function s(e){var t=new ArrayBuffer(e.length),n=new Uint8Array(t);for(var r=0;r!=e.length;++r)n[r]=e.charCodeAt(r)&255;return t}console.log(this);var r={bookType:"xlsx",bookSST:!0,type:"binary"},i=e.write(this,r);t(new Blob([s(i)],{type:""}),n)},s.prototype.set=function(t,n,i){var s=e.utils.encode_cell({c:t,r:n}),o={v:i};if(o.v==null){console.error("Attempting to write a null value, not doing anything");return}typeof o.v=="number"?o.t="n":typeof o.v=="boolean"?o.t="b":o.v instanceof Date?(o.t="n",o.z=e.SSF._table[14],o.v=r(o.v)):o.t="s",this[s]=o},s.prototype.border=function(e,t,n){},s.prototype.font=function(e,t,n){},s.prototype.width=function(e,t){this["!cols"][e].wch=t},s.prototype.makeTrippy=function(t,n){var r=e.utils.encode_cell({c:t,r:n});this[r].s={numFmtId:0,fontId:"5",fillId:0,borderId:"1",xfId:"0",applyFont:"1",applyBorder:"1"}},n});